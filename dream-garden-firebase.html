<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shit-Me's Dream Garden</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg,#ffeef8 0%,#f0e6ff 25%,#e6f3ff 50%,#fff0e6 75%,#ffe6f0 100%);
      min-height:100vh; position:relative; overflow-x:hidden;
    }
    .flower{position:absolute;font-size:24px;animation:float 15s infinite linear;opacity:.3;pointer-events:none;z-index:1}
    @keyframes float{
      0%{transform:translateY(100vh) rotate(0deg);opacity:0}
      10%,90%{opacity:.7}
      100%{transform:translateY(-100px) rotate(360deg);opacity:0}
    }
    .flower:nth-child(1){left:10%;animation-delay:0s}.flower:nth-child(2){left:20%;animation-delay:2s}
    .flower:nth-child(3){left:30%;animation-delay:4s}.flower:nth-child(4){left:40%;animation-delay:6s}
    .flower:nth-child(5){left:50%;animation-delay:8s}.flower:nth-child(6){left:60%;animation-delay:10s}
    .flower:nth-child(7){left:70%;animation-delay:12s}.flower:nth-child(8){left:80%;animation-delay:14s}
    .flower:nth-child(9){left:90%;animation-delay:16s}

    .container{max-width:800px;margin:0 auto;padding:20px;position:relative;z-index:10}
    .main-card{
      background:rgba(255,255,255,.95); backdrop-filter:blur(10px); border-radius:25px;
      box-shadow:0 20px 40px rgba(0,0,0,.1); padding:40px; border:1px solid rgba(255,255,255,.3);
      position:relative; overflow:hidden;
    }
    .main-card::before{
      content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
      background: radial-gradient(circle, rgba(255,182,193,.1) 0%, transparent 70%);
      animation:rotate 20s linear infinite; pointer-events:none;
    }
    @keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}

    .header{text-align:center;margin-bottom:30px;position:relative;z-index:2}
    .header h1{
      font-size:2.5em; background:linear-gradient(135deg,#ff6b9d,#c44569,#6c5ce7,#00b894);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
      margin-bottom:10px; font-weight:700;
    }
    .header p{color:#7d5ba6;font-size:1.1em;margin-bottom:20px}

    .status-bar{
      background:linear-gradient(135deg,#e0ffe0,#fff0f5);
      border-radius:15px;
      padding:15px;
      margin-bottom:20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border:2px solid rgba(0,184,148,.3);
    }
    .sync-status{font-size:14px;color:#7d5ba6;display:flex;align-items:center;gap:8px}
    .sync-dot{width:10px;height:10px;border-radius:50%;display:inline-block}
    .sync-dot.connected{background:#00b894;animation:pulse .8s infinite}
    .sync-dot.disconnected{background:#ff7675}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}

    .progress-section{background:linear-gradient(135deg,#ffd1dc,#e6e6fa);border-radius:20px;padding:20px;margin-bottom:30px;border:2px solid rgba(255,182,193,.3)}
    .progress-text{font-size:1.3em;font-weight:600;color:#6c5ce7;margin-bottom:15px}
    .progress-bar-container{width:100%;height:12px;background:rgba(255,255,255,.7);border-radius:10px;overflow:hidden;box-shadow:inset 0 2px 4px rgba(0,0,0,.1)}
    .progress-bar{height:100%;background:linear-gradient(90deg,#ff6b9d,#c44569,#6c5ce7);border-radius:10px;transition:width .8s ease;box-shadow:0 2px 8px rgba(255,107,157,.4)}

    .add-section{background:linear-gradient(135deg,#f8f9ff,#fff0f5);border-radius:20px;padding:25px;margin-bottom:30px;border:2px dashed rgba(255,182,193,.5)}
    .category-buttons{display:flex;gap:15px;margin-bottom:20px;justify-content:center;flex-wrap:wrap}
    .category-btn{padding:12px 24px;border:none;border-radius:25px;font-weight:600;cursor:pointer;transition:.3s;font-size:14px;display:flex;align-items:center;gap:8px}
    .category-btn.place{background:linear-gradient(135deg,#74b9ff,#0984e3);color:#fff}
    .category-btn.experience{background:linear-gradient(135deg,#fd79a8,#e84393);color:#fff}
    .category-btn:not(.active){background:rgba(255,255,255,.8);color:#666}
    .category-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.15)}

    .input-section{display:flex;gap:15px;align-items:center}
    .input-field{flex:1;padding:15px 20px;border:2px solid rgba(255,182,193,.3);border-radius:25px;font-size:16px;background:rgba(255,255,255,.9);transition:.3s}
    .input-field:focus{outline:none;border-color:#ff6b9d;box-shadow:0 0 0 4px rgba(255,107,157,.1)}
    .add-btn{padding:15px 25px;background:linear-gradient(135deg,#00b894,#00cec9);color:#fff;border:none;border-radius:25px;font-size:16px;font-weight:600;cursor:pointer;transition:.3s;display:flex;align-items:center;gap:8px}
    .add-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,184,148,.3)}
    .add-btn:disabled{opacity:.6;cursor:not-allowed}

    .filters{display:flex;gap:10px;margin-bottom:25px;justify-content:center;flex-wrap:wrap}
    .filter-btn{padding:8px 16px;border:2px solid rgba(124,91,166,.3);background:rgba(255,255,255,.8);color:#7c5ba6;border-radius:20px;cursor:pointer;transition:.2s;font-weight:500;text-transform:capitalize}
    .filter-btn.active{background:linear-gradient(135deg,#a29bfe,#6c5ce7);color:#fff;border-color:transparent}
    .filter-btn:hover{transform:translateY(-1px)}

    .items-container{display:flex;flex-direction:column;gap:15px}
    .list-item{background:rgba(255,255,255,.9);border-radius:20px;padding:20px;border:2px solid transparent;transition:.3s;display:flex;align-items:center;gap:15px;position:relative;overflow:hidden}
    .list-item::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);transition:left .5s}
    .list-item:hover::before{left:100%}
    .list-item:hover{transform:translateY(-3px);box-shadow:0 10px 30px rgba(0,0,0,.1);border-color:rgba(255,182,193,.5)}
    .list-item.completed{background:linear-gradient(135deg,#d1f2eb,#a7f3d0);opacity:.88}

    .checkbox{width:30px;height:30px;border-radius:50%;border:3px solid #ddd;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.2s;flex-shrink:0}
    .checkbox.completed{background:linear-gradient(135deg,#00b894,#00cec9);border-color:#00b894;color:#fff}
    .checkbox:hover{transform:scale(1.1)}

    .item-content{flex:1}
    .item-text{font-size:16px;color:#2d3436;margin-bottom:5px;transition:.2s}
    .item-text.completed{text-decoration:line-through;color:#636e72}
    .item-meta{display:flex;align-items:center;gap:8px;font-size:12px;color:#636e72}
    .category-tag{padding:4px 10px;border-radius:12px;font-weight:500;text-transform:capitalize}
    .category-tag.place{background:linear-gradient(135deg,#e3f2fd,#bbdefb);color:#1976d2}
    .category-tag.experience{background:linear-gradient(135deg,#fce4ec,#f8bbd9);color:#c2185b}

    .icon-btn{width:35px;height:35px;border:none;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s;flex-shrink:0}
    .edit-btn{background:linear-gradient(135deg,#ffb142,#ff793f);color:#fff}
    .edit-btn:hover{transform:scale(1.1);box-shadow:0 5px 15px rgba(255,121,63,.3)}
    .delete-btn{background:linear-gradient(135deg,#ff7675,#d63031);color:#fff}
    .delete-btn:hover{transform:scale(1.1);box-shadow:0 5px 15px rgba(214,48,49,.3)}

    .edit-row{display:flex;gap:10px;align-items:center}
    .edit-input{flex:1;padding:12px 16px;border:2px solid rgba(124,91,166,.25);border-radius:12px;font-size:15px}
    .save-btn{background:linear-gradient(135deg,#00b894,#00cec9);color:#fff}
    .cancel-btn{background:linear-gradient(135deg,#a29bfe,#6c5ce7);color:#fff}

    .empty-state{text-align:center;padding:60px 20px;color:#7d5ba6}
    .empty-state h3{font-size:1.5em;margin-bottom:10px}

    .celebration{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:50px;pointer-events:none;z-index:1000;animation:celebrate 2s ease-out}
    @keyframes celebrate{
      0%{opacity:0;transform:translate(-50%,-50%) scale(0)}
      50%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}
      100%{opacity:0;transform:translate(-50%,-50%) scale(1)}
    }

    @media (max-width:600px){
      .container{padding:10px}
      .main-card{padding:20px}
      .header h1{font-size:2em}
      .input-section{flex-direction:column}
      .input-field,.add-btn{width:100%}
      .status-bar{flex-direction:column;gap:10px}
    }
  </style>
</head>
<body>
  <!-- floating petals -->
  <div class="flower">üå∏</div><div class="flower">üåπ</div><div class="flower">üå∫</div>
  <div class="flower">üåª</div><div class="flower">üå∑</div><div class="flower">üåº</div>
  <div class="flower">üåª</div><div class="flower">üåπ</div><div class="flower">üå∏</div>

  <div class="container">
    <div class="main-card">
      <div class="header">
        <h1>Shit-Me's Dream Garden</h1>
        <p>A beautiful collection of places and moments for just the two of us</p>
      </div>

      <div class="status-bar">
        <span class="sync-status">
          <span class="sync-dot connected" id="syncDot"></span>
          <span id="syncText">Syncing...</span>
        </span>
      </div>

      <div class="progress-section">
        <div class="progress-text" id="progressText">0 of 0 dreams completed üå∫</div>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
      </div>

      <div class="add-section">
        <div class="category-buttons">
          <button class="category-btn place active" data-category="place">üìç Beautiful Place</button>
          <button class="category-btn experience" data-category="experience">üíï Sweet Experience</button>
        </div>
        <div class="input-section">
          <input type="text" class="input-field" id="newItemInput" placeholder="Add a place she dreams of visiting... üåç"/>
          <button class="add-btn" id="addBtn">‚ûï Add Dream</button>
        </div>
      </div>

      <div class="filters">
        <button class="filter-btn active" data-filter="all">All Dreams</button>
        <button class="filter-btn" data-filter="pending">Still Dreaming</button>
        <button class="filter-btn" data-filter="completed">Achieved üéâ</button>
        <button class="filter-btn" data-filter="place">Places</button>
        <button class="filter-btn" data-filter="experience">Experiences</button>
      </div>

      <div class="items-container" id="itemsContainer">
        <div class="empty-state">
          <h3>üå∏ Your dream garden awaits! üå∏</h3>
          <p>Connecting to the cloud...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>

  <script>
    // ===== FIREBASE CONFIGURATION =====
    // Go to Firebase Console, create a new project, get your config and paste it here
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- App state ---
    var dreamGarden = {
      items: [],
      currentCategory: 'place',
      currentFilter: 'all',
      editingId: null,
      connected: false,
      itemsRef: null,

      init: function(){
        this.itemsRef = db.ref('dreamGarden/items');
        this.setupRealtimeSync();
        this.initializeEventListeners();
      },

      setupRealtimeSync: function(){
        var self = this;

        // Monitor connection status
        db.ref('.info/connected').on('value', function(snap){
          self.connected = snap.val() === true;
          self.updateConnectionStatus();
        });

        // Listen for real-time updates
        this.itemsRef.on('value', function(snapshot){
          var data = snapshot.val();
          if (data){
            self.items = Object.keys(data).map(key => ({
              id: key,
              ...data[key]
            }));
          } else {
            self.items = [];
          }
          self.render();
        });

        // Listen for child removals
        this.itemsRef.on('child_removed', function(snapshot){
          self.render();
        });
      },

      updateConnectionStatus: function(){
        var dot = document.getElementById('syncDot');
        var text = document.getElementById('syncText');
        if (this.connected){
          dot.className = 'sync-dot connected';
          text.textContent = '‚úì Synced & Connected';
        } else {
          dot.className = 'sync-dot disconnected';
          text.textContent = '‚ö† Offline - Changes will sync when reconnected';
        }
      },

      initializeEventListeners: function(){
        var self = this;

        // category switch
        document.querySelectorAll('.category-btn').forEach(function(btn){
          btn.addEventListener('click', function(){
            document.querySelectorAll('.category-btn').forEach(b=>b.classList.remove('active'));
            this.classList.add('active');
            self.currentCategory = this.getAttribute('data-category');
            self.updatePlaceholder();
          });
        });

        // add new item
        document.getElementById('addBtn').addEventListener('click', function(){ self.addItem(); });
        document.getElementById('newItemInput').addEventListener('keydown', function(e){
          if (e.key === 'Enter') self.addItem();
        });

        // filters
        document.querySelectorAll('.filter-btn').forEach(function(btn){
          btn.addEventListener('click', function(){
            document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
            this.classList.add('active');
            self.currentFilter = this.getAttribute('data-filter');
            self.render();
          });
        });
      },

      updatePlaceholder: function(){
        var input = document.getElementById('newItemInput');
        input.placeholder = (this.currentCategory === 'place')
          ? "Add a place she dreams of visiting... üåç"
          : "Add an experience she wants to treasure... üíï";
      },

      addItem: function(){
        var input = document.getElementById('newItemInput');
        var text = input.value.trim();
        if (!text) return;

        var newItemRef = this.itemsRef.push();
        newItemRef.set({
          text: text,
          completed: false,
          category: this.currentCategory,
          createdAt: firebase.database.ServerValue.TIMESTAMP
        }).then(function(){
          input.value = '';
          dreamGarden.showCelebration('üå±');
        }).catch(function(error){
          console.error('Error adding item:', error);
          alert('Failed to add item. Check console.');
        });
      },

      startEdit: function(id){
        this.editingId = id;
        this.render();
      },

      saveEdit: function(id){
        var input = document.getElementById('editInput_'+id);
        if (!input) return this.cancelEdit();
        var text = input.value.trim();
        if (!text) return;

        this.itemsRef.child(id).update({
          text: text
        }).then(function(){
          dreamGarden.editingId = null;
          dreamGarden.render();
        }).catch(function(error){
          console.error('Error saving edit:', error);
        });
      },

      cancelEdit: function(){
        this.editingId = null;
        this.render();
      },

      toggleItem: function(id){
        var item = this.items.find(it => it.id === id);
        if (!item) return;

        this.itemsRef.child(id).update({
          completed: !item.completed
        }).then(function(){
          if (!item.completed){
            var emojis = ['üéâ','üå∏','‚ú®','üíñ','üå∫'];
            dreamGarden.showCelebration(emojis[Math.floor(Math.random()*emojis.length)]);
          }
        }).catch(function(error){
          console.error('Error toggling item:', error);
        });
      },

      removeItem: function(id){
        this.itemsRef.child(id).remove().catch(function(error){
          console.error('Error removing item:', error);
        });
      },

      getFilteredItems: function(){
        var f = this.currentFilter;
        return this.items.filter(function(item){
          if (f === 'all') return true;
          if (f === 'completed') return item.completed;
          if (f === 'pending') return !item.completed;
          return item.category === f;
        });
      },

      showCelebration: function(emoji){
        var el = document.createElement('div');
        el.className = 'celebration';
        el.textContent = emoji;
        document.body.appendChild(el);
        setTimeout(()=>document.body.removeChild(el), 2000);
      },

      updateProgress: function(){
        var completed = this.items.filter(i=>i.completed).length;
        var total = this.items.length;
        var pct = total ? (completed/total)*100 : 0;
        document.getElementById('progressText').textContent =
          completed + " of " + total + " dreams completed " + (completed>0 ? "üå∫" : "üå±");
        document.getElementById('progressBar').style.width = pct + "%";
      },

      renderItems: function(){
        var container = document.getElementById('itemsContainer');
        var list = this.getFilteredItems();

        if (!list.length){
          container.innerHTML =
            '<div class="empty-state"><h3>' +
            (this.currentFilter==='all' ? 'üå∏ Your dream garden awaits! üå∏' : 'No '+this.currentFilter+' dreams found') +
            '</h3><p>' +
            (this.currentFilter==='all' ? 'Add the first dream destination or experience to start blooming' :
              'Try adding some '+this.currentFilter+' items or check other filters') +
            '</p></div>';
          return;
        }

        var html = '';
        for (var i=0;i<list.length;i++){
          var item = list[i];
          var editing = (item.id === this.editingId);

          html += '<div class="list-item '+(item.completed?'completed':'')+'">' +
                    '<div class="checkbox '+(item.completed?'completed':'')+'" onclick="dreamGarden.toggleItem(\''+this.escapeHtml(item.id)+'\')">'+
                      (item.completed ? '‚úì' : '') +
                    '</div>' +
                    '<div class="item-content">';

          if (editing){
            html += '<div class="edit-row">' +
                      '<input id="editInput_'+this.escapeHtml(item.id)+'" class="edit-input" type="text" value="'+this.escapeHtml(item.text)+'" />' +
                      '<button class="icon-btn save-btn" title="Save" onclick="dreamGarden.saveEdit(\''+this.escapeHtml(item.id)+'\')">üíæ</button>' +
                      '<button class="icon-btn cancel-btn" title="Cancel" onclick="dreamGarden.cancelEdit()">‚Ü©</button>' +
                    '</div>';
          } else {
            html += '<div class="item-text '+(item.completed?'completed':'')+'">'+ this.escapeHtml(item.text) +'</div>' +
                    '<div class="item-meta">' +
                      '<span class="category-tag '+item.category+'">' + (item.category==='place'?'üìç':'üíï') + ' ' + item.category + '</span>' +
                    '</div>';
          }

          html +=   '</div>' +
                    '<button class="icon-btn edit-btn" title="Edit" onclick="dreamGarden.startEdit(\''+this.escapeHtml(item.id)+'\')">‚úèÔ∏è</button>' +
                    '<button class="icon-btn delete-btn" title="Delete" onclick="dreamGarden.removeItem(\''+this.escapeHtml(item.id)+'\')">√ó</button>' +
                  '</div>';
        }
        container.innerHTML = html;
      },

      escapeHtml: function(s){
        return String(s).replace(/[&<>"']/g, (c)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c]));
      },

      render: function(){
        this.updateProgress();
        this.renderItems();
      }
    };

    dreamGarden.init();
  </script>
</body>
</html>
